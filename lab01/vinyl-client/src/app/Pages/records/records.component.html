<div class="container py-5">
    <div class="row mb-3">
        <div class="col-lg-6">
            <form [formGroup]="formBarcode">
                <label class="card-title">Найти пластинку по штрихкоду</label>
                <input type="text" formControlName="filterSearch" class="form-control"
                    (keyup.enter)="searchByBarcode()" placeholder="Введите штрихкод">
            </form>
        </div>
        <div class="col-lg-6">
            <form [formGroup]="formName">
                <label class="card-title">Найти пластинку по имени</label>
                <input type="text" formControlName="filterSearch" class="form-control"
                    (keyup.enter)="searchByName()" placeholder="Введите имя">
            </form>
        </div>
    </div>
    <div class="row">
        <!-- Сайдбар с фильтрами -->
        <div class="col-lg-3 mb-4">
            <div class="filter-sidebar">
                <div class="filter-header">
                    <h5>Фильтры</h5>
                    <span class="reset-filters" (click)="resetFilter()">Сбросить</span>
                </div>

                <form [formGroup]="form" (ngSubmit)="getRecordsWithFilters()">
                    <!-- Фильтр по жанрам -->
                    <div class="filter-group">
                        <div class="filter-title">Жанры</div>
                        <div class="form-check" *ngFor="let genre of genres">
                            <input class="form-check-input" type="radio" name="genre" [id]="'genre-' + genre.id"
                                [value]="genre.id" (change)="form.patchValue({ genre_id: genre.id })">
                            <label class="form-check-label" [for]="'genre-' + genre.id">
                                {{ genre.name }}
                            </label>
                        </div>
                    </div>

                    <!-- Фильтр по годам -->
                    <div class="filter-group">
                        <div class="filter-title">Годы</div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="decade" id="decade-1950" value="1950"
                                (change)="form.patchValue({ decade: 1950 })">
                            <label class="form-check-label" for="decade-1950">1950-е</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="decade" id="decade-1960" value="1960"
                                (change)="form.patchValue({ decade: 1960 })">
                            <label class="form-check-label" for="decade-1960">1960-е</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="decade" id="decade-1970" value="1970"
                                (change)="form.patchValue({ decade: 1970 })">
                            <label class="form-check-label" for="decade-1970">1970-е</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="decade" id="decade-1980" value="1980"
                                (change)="form.patchValue({ decade: 1980 })">
                            <label class="form-check-label" for="decade-1980">1980-е</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="decade" id="decade-1990" value="1990"
                                (change)="form.patchValue({ decade: 1990 })">
                            <label class="form-check-label" for="decade-1990">1990-е</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="decade" id="decade-2000" value="2000"
                                (change)="form.patchValue({ decade: 2000 })">
                            <label class="form-check-label" for="decade-2000">2000-е</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="decade" id="decade-2010" value="2010"
                                (change)="form.patchValue({ decade: 2010 })">
                            <label class="form-check-label" for="decade-2010">2010-е</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="decade" id="decade-2020" value="2020"
                                (change)="form.patchValue({ decade: 2020 })">
                            <label class="form-check-label" for="decade-2020">2020-е</label>
                        </div>
                    </div>

                    <!-- Фильтр по исполнителям -->
                    <div class="filter-group">
                        <div class="filter-title">Исполнители</div>
                        <div class="form-check" *ngFor="let performer of performers">

                            <input class="form-check-input" type="radio" name="performer"
                                [id]="'performer-' + performer.id" [value]="performer.id"
                                (change)="form.patchValue({ performer_id: performer.id })">
                            <label class="form-check-label" [for]="'performer-' + performer.id">
                                {{ performer.name }}
                            </label>
                        </div>
                    </div>

                    <!-- Фильтр по группам -->
                    <div class="filter-group">
                        <div class="filter-title">Группы</div>
                        <div class="form-check" *ngFor="let group of groups">
                            <input class="form-check-input" type="radio" name="group" [id]="'group-' + group.id"
                                [value]="group.id" (change)="form.patchValue({ group_id: group.id })">
                            <label class="form-check-label" [for]="'group-' + group.id">
                                {{ group.name }}
                            </label>
                        </div>
                    </div>

                    <button type="submit" class="btn btn-primary ">Применить фильтры</button>
                </form>
            </div>
        </div>
        
        <!-- Основной контент - каталог -->
        <div class="col-lg-8 ms-lg-3">
            <h2 class="mb-3" *ngIf="queryBarcode != '' ">Каталог пластинок (по штрихкоду: {{queryBarcode}})</h2>
            <h2 class="mb-3" *ngIf="queryName != '' ">Каталог пластинок (по имени: {{queryName}})</h2>
            <h2 class="mb-3" *ngIf="queryName == '' && queryBarcode == ''">Каталог пластинок</h2>
            <div class="row ms-1 g-4">
                <div class="custom-card col-lg-2 col-md-4 col-sm-6 me-4" *ngFor="let record of records">
                    <a href="/record/{{ record.id }}" class="card-href">
                        <img src={{record.coverUrl}} alt="Обложка" class="cover">
                        <div class="card-title">{{record.title}}</div>
                        <div class="card-year">{{record.year}}</div>
                        <span class="card-genre">{{record.genre}}</span>
                    </a>
                    <button class="btn btn-sm" (click)="addToUserCollection(record)">В коллекцию</button>
                    <button class="btn btn-sm disabled">В коллекции</button>
                </div>
            </div>
        </div>
    </div>
</div>